-- Create tables for customers, orders, and order items
CREATE TABLE Customers (
    customer_id INT PRIMARY KEY,
    name VARCHAR(50)
);

CREATE TABLE Orders (
    order_id INT PRIMARY KEY,
    customer_id INT,
    order_date DATE,
    status VARCHAR(20),
    FOREIGN KEY (customer_id) REFERENCES Customers(customer_id)
);

CREATE TABLE Order_Items (
    item_id INT PRIMARY KEY,
    order_id INT,
    product_name VARCHAR(50),
    quantity INT,
    FOREIGN KEY (order_id) REFERENCES Orders(order_id)
);

-- Insert sample data
INSERT INTO Customers VALUES (1, 'Alice'), (2, 'Bob');
INSERT INTO Orders VALUES (1, 1, '2025-01-01', 'Shipped'), (2, 2, '2025-01-02', 'Pending');
INSERT INTO Order_Items VALUES (1, 1, 'Book', 2), (2, 2, 'Pen', 10);

-- Query: Find pending orders with total quantity
SELECT c.name, o.order_id, o.order_date, SUM(oi.quantity) AS total_quantity
FROM Orders o
JOIN Customers c ON o.customer_id = c.customer_id
JOIN Order_Items oi ON o.order_id = oi.order_id
WHERE o.status = 'Pending'
GROUP BY c.name, o.order_id, o.order_date;
