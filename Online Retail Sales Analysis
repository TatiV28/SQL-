-- Create tables for products, regions, and sales
CREATE TABLE Regions (
    region_id INT PRIMARY KEY,
    region_name VARCHAR(50)
);

CREATE TABLE Products (
    product_id INT PRIMARY KEY,
    product_name VARCHAR(100),
    price DECIMAL(10, 2)
);

CREATE TABLE Sales (
    sale_id INT PRIMARY KEY,
    product_id INT,
    region_id INT,
    sale_date DATE,
    quantity INT,
    FOREIGN KEY (product_id) REFERENCES Products(product_id),
    FOREIGN KEY (region_id) REFERENCES Regions(region_id)
);

-- Insert sample data
INSERT INTO Regions VALUES (1, 'North'), (2, 'South');
INSERT INTO Products VALUES (1, 'Laptop', 999.99), (2, 'Phone', 499.99);
INSERT INTO Sales VALUES (1, 1, 1, '2025-01-10', 5), (2, 2, 2, '2025-02-15', 10);

-- Query: Calculate total revenue by region and product
SELECT r.region_name, p.product_name, SUM(s.quantity * p.price) AS total_revenue
FROM Sales s
JOIN Products p ON s.product_id = p.product_id
JOIN Regions r ON s.region_id = r.region_id
GROUP BY r.region_name, p.product_name
ORDER BY total_revenue DESC;
